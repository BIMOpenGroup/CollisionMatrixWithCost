## Цели
- Отображать и управлять предложениями стоимости (LLM+эвристики) по дисциплинам и элементам.
- Давать пользователю подтверждать/отклонять предложения с атрибуцией источников.
- Вести аудит‑лог действий и показывать статус (proposed/accepted/rejected).

## Backend (опоры и доработки)
- Использовать существующие:
  - `GET /api/matrix` — исходная матрица.
  - `POST /api/prices/scrape`, `GET /api/prices` — загрузка/чтение цен.
  - `POST /api/mapping/suggest`, `GET /api/mapping` — предложения по дисциплинам.
  - `POST /api/mapping/elements/suggest`, `GET /api/mapping/elements` — предложения по элементам.
  - `POST /api/debug/llm/rerank`, `GET /api/debug/llm/providers` — проверка LLM.
- Добавить:
  - `POST /api/mapping/suggestions/:id/status` body `{status}` — принять/отклонить дисциплину.
  - `POST /api/mapping/elements/:id/status` body `{status}` — принять/отклонить элемент.
  - `GET /api/events/suggestions?limit=...` — аудит‑лог принятых/отклонённых с источниками.
  - Расширить `GET /api/mapping*` ответ полями источника (`source`, `source_page`) через JOIN к `prices`.

## Frontend (UI)
- Панель управления мэппингом:
  - Кнопки «Сгенерировать (LLM+эвристики)» для дисциплин и элементов.
  - Индикатор провайдера LLM и доступности ключей (пинг).
- Просмотр предложений:
  - Вкладки «Дисциплины» и «Элементы».
  - Таблица: `name`, `unit`, `category`, `score`, `source` (ссылка), `status`.
  - Действия: «Принять»/«Отклонить» → POST статус; мгновенное обновление строки.
  - Фильтры по `grp/element/discipline/status`, сортировка по `score`.
- Аудит‑лог:
  - Отдельная вкладка со списком событий (кто/что/когда, источник/страница).
- Матрица:
  - Подсказка ячейки с категориями Major/Medium/Minor по заданным правилам.

## UX и правила
- Источники («Не исправлять ссылки на другие сайты») — показывать как есть, открывать в новой вкладке.
- Безопасность: скрывать ключи LLM; не логировать секреты; обрабатывать ошибки API.
- Производительность: пагинация в таблицах, лимиты `limit` на запросах.

## Этапы внедрения
1) Backend: статус‑эндпоинты, аудит‑таблица, JOIN источников в ответы.
2) Frontend: список предложений (элементы), действия accept/reject, отображение источников.
3) Frontend: вкладка дисциплин, фильтры, сортировка.
4) Frontend: аудит‑лог, пинг LLM, индикаторы.
5) Полировка: категории ячеек, подсказки, мини‑тесты и smoke‑проверки.

## Проверка
- Скрипт скрейпа цен → генерация предложений → выбор элемента/дисциплины → принятие/отклонение → аудит‑лог отображает событие.
- Валидация LLM через `/api/debug/llm/rerank` и `/api/debug/llm/providers`.